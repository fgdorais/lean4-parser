<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../.././style.css"></link><link rel="icon" href="../../.././favicon.svg"></link><link rel="mask-icon" href="../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Server.Rpc.Basic</title><script defer="true" src="../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../.././";</script><script>const MODULE_NAME="Lean.Server.Rpc.Basic";</script><script type="module" src="../../.././jump-src.js"></script><script type="module" src="../../.././search.js"></script><script type="module" src="../../.././expand-nav.js"></script><script type="module" src="../../.././how-about.js"></script><script type="module" src="../../.././instances.js"></script><script type="module" src="../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">Rpc</span>.<span class="name">Basic</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../.././Init/Dynamic.html">Init.Dynamic</a></li><li><a href="../../.././Lean/Data/Json.html">Lean.Data.Json</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Server.Rpc.Basic" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Lsp.RpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">RpcRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Lsp.instBEqRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instBEqRpcRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Lsp.instHashableRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instHashableRpcRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Lsp.instFromJsonRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instFromJsonRpcRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Lsp.instToJsonRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instToJsonRpcRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Lsp.instToStringRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instToStringRpcRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RpcObjectStore"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RpcObjectStore</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.rpcStoreRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">rpcStoreRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.rpcGetRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">rpcGetRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.rpcReleaseRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">rpcReleaseRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.RpcEncodable"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RpcEncodable</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instNonemptyRpcEncodable"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instNonemptyRpcEncodable</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instRpcEncodableOfFromJsonOfToJson"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableOfFromJsonOfToJson</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instRpcEncodableOption"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableOption</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instRpcEncodableArray"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableArray</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instRpcEncodableProd"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableProd</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instRpcEncodableStateMRpcObjectStore"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableStateMRpcObjectStore</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.WithRpcRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">WithRpcRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instInhabitedWithRpcRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedWithRpcRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instRpcEncodableWithRpcRefOfTypeName"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableWithRpcRefOfTypeName</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcEncode"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableWithRpcRefOfTypeName</span>.<span class="name">rpcEncode</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcDecode"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableWithRpcRefOfTypeName</span>.<span class="name">rpcDecode</span></a></div></nav><main>
<div class="mod_doc"><p>Allows LSP clients to make Remote Procedure Calls to the server.</p><p>The single use case for these is to allow the infoview UI to refer to and manipulate heavy-weight
objects residing on the server. It would be inefficient to serialize these into JSON and send over.
For example, the client can format an <code>Expr</code> without transporting the whole <code>Environment</code>.</p><p>All RPC requests are relative to an open file and an RPC session for that file. The client must
first connect to the session using <code>$/lean/rpc/connect</code>.</p></div><div class="decl" id="Lean.Lsp.RpcRef"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L22-L27">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">RpcRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a></div></div><p>An object which RPC clients can refer to without marshalling.</p><ul class="structure_fields" id="Lean.Lsp.RpcRef.mk"><li id="Lean.Lsp.RpcRef.p" class="structure_field"><div class="structure_field_info">p : <a href="../../.././Init/Prelude.html#USize">USize</a></div></li></ul><details id="instances-for-list-Lean.Lsp.RpcRef" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Lsp.instBEqRpcRef"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L27-L27">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instBEqRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instBEqRpcRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#BEq">BEq</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">RpcRef</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instBEqRpcRef">Lean.Lsp.instBEqRpcRef</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Init/Prelude.html#BEq.mk">{</a> <span class="fn">beq</span> := <a href="../../.././Lean/Server/Rpc/Basic.html#_private.Lean.Server.Rpc.Basic.0.Lean.Lsp.beqRpcRef._@.Lean.Server.Rpc.Basic._hyg.16">Lean.Lsp.beqRpcRef✝</a> <a href="../../.././Init/Prelude.html#BEq.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Lsp.instHashableRpcRef"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L27-L27">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instHashableRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instHashableRpcRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Hashable">Hashable</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">RpcRef</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instHashableRpcRef">Lean.Lsp.instHashableRpcRef</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Init/Prelude.html#Hashable.mk">{</a> <span class="fn">hash</span> := <a href="../../.././Lean/Server/Rpc/Basic.html#_private.Lean.Server.Rpc.Basic.0.Lean.Lsp.hashRpcRef._@.Lean.Server.Rpc.Basic._hyg.74">Lean.Lsp.hashRpcRef✝</a> <a href="../../.././Init/Prelude.html#Hashable.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Lsp.instFromJsonRpcRef"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L27-L27">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instFromJsonRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instFromJsonRpcRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Data/Json/FromToJson.html#Lean.FromJson">FromJson</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">RpcRef</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instFromJsonRpcRef">Lean.Lsp.instFromJsonRpcRef</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Lean/Data/Json/FromToJson.html#Lean.FromJson.mk">{</a> <span class="fn">fromJson?</span> := <a href="../../.././Lean/Server/Rpc/Basic.html#_private.Lean.Server.Rpc.Basic.0.Lean.Lsp.fromJsonRpcRef._@.Lean.Server.Rpc.Basic._hyg.106">Lean.Lsp.fromJsonRpcRef✝</a> <a href="../../.././Lean/Data/Json/FromToJson.html#Lean.FromJson.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Lsp.instToJsonRpcRef"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L27-L27">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instToJsonRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instToJsonRpcRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Data/Json/FromToJson.html#Lean.ToJson">ToJson</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">RpcRef</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instToJsonRpcRef">Lean.Lsp.instToJsonRpcRef</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Lean/Data/Json/FromToJson.html#Lean.ToJson.mk">{</a> <span class="fn">toJson</span> := <a href="../../.././Lean/Server/Rpc/Basic.html#_private.Lean.Server.Rpc.Basic.0.Lean.Lsp.toJsonRpcRef._@.Lean.Server.Rpc.Basic._hyg.173">Lean.Lsp.toJsonRpcRef✝</a> <a href="../../.././Lean/Data/Json/FromToJson.html#Lean.ToJson.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Lsp.instToStringRpcRef"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L29-L30">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instToStringRpcRef"><span class="name">Lean</span>.<span class="name">Lsp</span>.<span class="name">instToStringRpcRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Data/ToString/Basic.html#ToString">ToString</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">RpcRef</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.instToStringRpcRef">Lean.Lsp.instToStringRpcRef</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Init/Data/ToString/Basic.html#ToString.mk">{</a> <span class="fn">toString</span> := <span class="fn">fun (<span class="fn">r</span> : <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">Lean.Lsp.RpcRef</a>) =&gt; <span class="fn"><a href="../../.././Init/Data/ToString/Basic.html#ToString.toString">toString</a> <span class="fn"><span class="fn">r</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef.p">p</a></span></span></span> <a href="../../.././Init/Data/ToString/Basic.html#ToString.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Server.RpcObjectStore"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L36-L46">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RpcObjectStore</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Server.RpcObjectStore.mk"><li id="Lean.Server.RpcObjectStore.aliveRefs" class="structure_field"><div class="structure_field_info">aliveRefs : <span class="fn"><a href="../../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap">PersistentHashMap</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">Lsp.RpcRef</a> <a href="../../.././Init/Dynamic.html#Dynamic">Dynamic</a></span></div><div class="structure_field_doc"><p>Objects that are being kept alive for the RPC client, together with their type names,
mapped to by their RPC reference.</p><p>Note that we may currently have multiple references to the same object. It is only disposed
of once all of those are gone. This simplifies the client a bit as it can drop every reference
received separately.</p></div></li><li id="Lean.Server.RpcObjectStore.nextRef" class="structure_field"><div class="structure_field_info">nextRef : <a href="../../.././Init/Prelude.html#USize">USize</a></div><div class="structure_field_doc"><p>Value to use for the next <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">RpcRef</a></code>. It is monotonically increasing to avoid any possible
bugs resulting from its reuse.</p></div></li></ul><details id="instances-for-list-Lean.Server.RpcObjectStore" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.rpcStoreRef"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L48-L54">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.rpcStoreRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">rpcStoreRef</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">any</span> : <a href="../../.././Init/Dynamic.html#Dynamic">Dynamic</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Control/State.html#StateM">StateM</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore">RpcObjectStore</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">Lsp.RpcRef</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.rpcStoreRef">Lean.Server.rpcStoreRef</a> <span class="fn">any</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">st</span> ← <a href="../../.././Init/Prelude.html#MonadState.get">get</a>
  <span class="fn"><a href="../../.././Init/Prelude.html#MonadStateOf.set">set</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.mk">{</a> <span class="fn">aliveRefs</span> := <span class="fn"><span class="fn"><span class="fn"><span class="fn">st</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.aliveRefs">aliveRefs</a></span>.<a href="../../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap.insert">insert</a></span> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef.mk">{</a> <span class="fn">p</span> := <span class="fn"><span class="fn">st</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.nextRef">nextRef</a></span> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef.mk">}</a> <span class="fn">any</span></span>, <span class="fn">nextRef</span> := <span class="fn"><span class="fn">st</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.nextRef">nextRef</a></span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.mk">}</a></span>
  <span class="fn"><a href="../../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef.mk">{</a> <span class="fn">p</span> := <span class="fn"><span class="fn">st</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.nextRef">nextRef</a></span> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef.mk">}</a></span></span></li></ul></details><details id="instances-for-list-Lean.Server.rpcStoreRef" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.rpcGetRef"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L56-L57">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.rpcGetRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">rpcGetRef</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">r</span> : <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">Lsp.RpcRef</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore">RpcObjectStore</a> <a href="../../.././Init/Control/Id.html#Id">Id</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Option">Option</a> <a href="../../.././Init/Dynamic.html#Dynamic">Dynamic</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.rpcGetRef">Lean.Server.rpcGetRef</a> <span class="fn">r</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <a href="../../.././Init/Prelude.html#MonadReader.read">read</a>
  <span class="fn"><a href="../../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<span class="fn"><span class="fn"><span class="fn">__do_lift</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.aliveRefs">aliveRefs</a></span>.<a href="../../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap.find?">find?</a></span> <span class="fn">r</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Server.rpcGetRef" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.rpcReleaseRef"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L59-L65">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.rpcReleaseRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">rpcReleaseRef</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">r</span> : <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">Lsp.RpcRef</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Control/State.html#StateM">StateM</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore">RpcObjectStore</a> <a href="../../.././Init/Prelude.html#Bool">Bool</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.rpcReleaseRef">Lean.Server.rpcReleaseRef</a> <span class="fn">r</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">st</span> ← <a href="../../.././Init/Prelude.html#MonadState.get">get</a>
  <a href="../../.././Init/Prelude.html#ite">if</a> <span class="fn"><span class="fn"><span class="fn"><span class="fn">st</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.aliveRefs">aliveRefs</a></span>.<a href="../../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap.contains">contains</a></span> <span class="fn">r</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Init/Prelude.html#Bool.true">true</a> <a href="../../.././Init/Prelude.html#ite">then</a> <span class="fn">do
      <span class="fn"><a href="../../.././Init/Prelude.html#MonadStateOf.set">set</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.mk">{</a> <span class="fn">aliveRefs</span> := <span class="fn"><span class="fn"><span class="fn"><span class="fn">st</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.aliveRefs">aliveRefs</a></span>.<a href="../../.././Lean/Data/PersistentHashMap.html#Lean.PersistentHashMap.erase">erase</a></span> <span class="fn">r</span></span>, <span class="fn">nextRef</span> := <span class="fn"><span class="fn">st</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.nextRef">nextRef</a></span> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore.mk">}</a></span>
      <span class="fn"><a href="../../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../../.././Init/Prelude.html#Bool.true">true</a></span></span>
    <a href="../../.././Init/Prelude.html#ite">else</a> <span class="fn"><a href="../../.././Init/Prelude.html#Pure.pure">pure</a> <a href="../../.././Init/Prelude.html#Bool.false">false</a></span></span></li></ul></details><details id="instances-for-list-Lean.Server.rpcReleaseRef" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.RpcEncodable"><div class="class"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L67-L92">source</a></div><div class="decl_header"><span class="decl_kind">class</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">RpcEncodable</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a></div></div><p><code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> α</code> means that <code>α</code> can be deserialized from and serialized into JSON
for the purpose of receiving arguments to and sending return values from
Remote Procedure Calls (RPCs).</p><p>Any type with <code>FromJson</code> and <code>ToJson</code> instances is <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a></code>.</p><p>Furthermore, types that do not have these instances may still be <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a></code>.
Use <code>deriving <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a></code> to automatically derive instances for such types.</p><p>This occurs when <code>α</code> contains data that should not or cannot be serialized:
for instance, heavy objects such as <code><a href="../../.././Lean/Environment.html#Lean.Environment">Lean.Environment</a></code>, or closures.
For such data, we use the <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef">WithRpcRef</a></code> marker.
Note that for <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef">WithRpcRef</a> α</code> to be <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a></code>,
<code>α</code> must have a <code><a href="../../.././Init/Dynamic.html#TypeName">TypeName</a></code> instance</p><p>On the server side, <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef">WithRpcRef</a> α</code> is just a structure
containing a value of type <code>α</code>.
On the client side, it is an opaque reference of (structural) type <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Lsp.RpcRef">Lsp.RpcRef</a></code>.
Thus, <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef">WithRpcRef</a> α</code> is cheap to transmit over the network
but may only be accessed on the server side.
In practice, it is used by the client to pass data
between various RPC methods provided by the server.</p><ul class="structure_fields" id="Lean.Server.RpcEncodable.mk"><li id="Lean.Server.RpcEncodable.rpcEncode" class="structure_field"><div class="structure_field_info">rpcEncode : <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../../.././Init/Control/State.html#StateM">StateM</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore">RpcObjectStore</a> <a href="../../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a></span></span></div></li><li id="Lean.Server.RpcEncodable.rpcDecode" class="structure_field"><div class="structure_field_info">rpcDecode : <span class="fn"><a href="../../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a> → <span class="fn"><a href="../../.././Init/Control/Except.html#ExceptT">ExceptT</a> <a href="../../.././Init/Prelude.html#String">String</a> <span class="fn">(<a href="../../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore">RpcObjectStore</a> <a href="../../.././Init/Control/Id.html#Id">Id</a>)</span> <span class="fn">α</span></span></span></div></li></ul><details class="instances"><summary>Instances</summary><ul id="instances-list-Lean.Server.RpcEncodable" class="instances-list"></ul></details></div></div><div class="decl" id="Lean.Server.instNonemptyRpcEncodable"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L95-L96">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instNonemptyRpcEncodable"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instNonemptyRpcEncodable</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">(<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">α</span>)</span></span></div></div></div></div><div class="decl" id="Lean.Server.instRpcEncodableOfFromJsonOfToJson"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L98-L100">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableOfFromJsonOfToJson"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableOfFromJsonOfToJson</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Lean/Data/Json/FromToJson.html#Lean.FromJson">FromJson</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Lean/Data/Json/FromToJson.html#Lean.ToJson">ToJson</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">α</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableOfFromJsonOfToJson">Lean.Server.instRpcEncodableOfFromJsonOfToJson</a> <a href="../../.././Init/Prelude.html#Eq">=</a>   <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable.mk">{</a> <span class="fn">rpcEncode</span> := <span class="fn">fun (<span class="fn">a</span> : <span class="fn">α</span>) =&gt; <span class="fn"><a href="../../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<a href="../../.././Lean/Data/Json/FromToJson.html#Lean.ToJson.toJson">Lean.toJson</a> <span class="fn">a</span>)</span></span></span>, <span class="fn">rpcDecode</span> := <span class="fn">fun (<span class="fn">j</span> : <a href="../../.././Lean/Data/Json/Basic.html#Lean.Json">Lean.Json</a>) =&gt; <span class="fn"><a href="../../.././Init/Prelude.html#MonadExcept.ofExcept">ofExcept</a> <span class="fn">(<a href="../../.././Lean/Data/Json/FromToJson.html#Lean.FromJson.fromJson?">Lean.fromJson?</a> <span class="fn">j</span>)</span></span></span> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Server.instRpcEncodableOption"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L102-L104">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableOption"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableOption</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Option">Option</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Server.instRpcEncodableArray"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L108-L110">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableArray"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableArray</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">(<a href="../../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Server.instRpcEncodableProd"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L112-L116">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableProd"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableProd</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α </span><span class="fn">β</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">β</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> (<span class="fn">α</span> <a href="../../.././Init/Prelude.html#Prod">×</a> <span class="fn">β</span>)</span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Server.instRpcEncodableStateMRpcObjectStore"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L118-L122">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableStateMRpcObjectStore"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableStateMRpcObjectStore</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">(<a href="../../.././Init/Control/State.html#StateM">StateM</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore">RpcObjectStore</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Server.WithRpcRef"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L124-L129">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">WithRpcRef</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a> u)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../.././foundational_types.html">Type</a> u</div></div><p>Marks values to be encoded as opaque references in RPC packets.</p><p>See the docstring for <code><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a></code>.</p><ul class="structure_fields" id="Lean.Server.WithRpcRef.mk"><li id="Lean.Server.WithRpcRef.val" class="structure_field"><div class="structure_field_info">val : <span class="fn">α</span></div></li></ul><details id="instances-for-list-Lean.Server.WithRpcRef" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.instInhabitedWithRpcRef"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L129-L129">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instInhabitedWithRpcRef"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instInhabitedWithRpcRef</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">a✝</span> : <a href="../../.././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">a✝</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">(<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef">WithRpcRef</a> <span class="fn">a✝</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instInhabitedWithRpcRef">Lean.Server.instInhabitedWithRpcRef</a> <a href="../../.././Init/Prelude.html#Eq">=</a> <a href="../../.././Init/Prelude.html#Inhabited.mk">{</a> <span class="fn">default</span> := <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef.mk">{</a> <span class="fn">val</span> := <a href="../../.././Init/Prelude.html#Inhabited.default">default</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef.mk">}</a> <a href="../../.././Init/Prelude.html#Inhabited.mk">}</a></li></ul></details></div></div><div class="decl" id="Lean.Server.instRpcEncodableWithRpcRefOfTypeName"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L131-L144">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableWithRpcRefOfTypeName"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableWithRpcRefOfTypeName</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Init/Dynamic.html#TypeName">TypeName</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcEncodable">RpcEncodable</a> <span class="fn">(<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef">WithRpcRef</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcEncode"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L135-L135">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcEncode"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableWithRpcRefOfTypeName</span>.<span class="name">rpcEncode</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Init/Dynamic.html#TypeName">TypeName</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">r</span> : <span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef">WithRpcRef</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Control/State.html#StateM">StateM</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore">RpcObjectStore</a> <a href="../../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcEncode">Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcEncode</a> <span class="fn">r</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a>   <a href="../../.././Lean/Data/Json/FromToJson.html#Lean.ToJson.toJson">Lean.toJson</a> <a href="../../.././Init/Prelude.html#Functor.map">&lt;$&gt;</a> <span class="fn"><a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.rpcStoreRef">Lean.Server.rpcStoreRef</a> <span class="fn">(<a href="../../.././Init/Dynamic.html#Dynamic.mk">Dynamic.mk</a> <span class="fn"><span class="fn">r</span>.<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef.val">val</a></span>)</span></span></li></ul></details><details id="instances-for-list-Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcEncode" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcDecode"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/81b85203c90439fb7d7e0cec32130d62d8cb7a2e/src/Lean/Server/Rpc/Basic.lean#L136-L144">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcDecode"><span class="name">Lean</span>.<span class="name">Server</span>.<span class="name">instRpcEncodableWithRpcRefOfTypeName</span>.<span class="name">rpcDecode</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href="../../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../../.././Init/Dynamic.html#TypeName">TypeName</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">j</span> : <a href="../../.././Lean/Data/Json/Basic.html#Lean.Json">Json</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Init/Control/Except.html#ExceptT">ExceptT</a> <a href="../../.././Init/Prelude.html#String">String</a> <span class="fn">(<a href="../../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.RpcObjectStore">RpcObjectStore</a> <a href="../../.././Init/Control/Id.html#Id">Id</a>)</span> <span class="fn">(<a href="../../.././Lean/Server/Rpc/Basic.html#Lean.Server.WithRpcRef">WithRpcRef</a> <span class="fn">α</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Server.instRpcEncodableWithRpcRefOfTypeName.rpcDecode" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>